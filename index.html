<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bar San Luigi</title>
<style>
  :root { --brand:#3f51b5; --brand-dark:#283593; --brand-darker:#1a237e; --ok:#4caf50; }
  * { box-sizing: border-box; }
  body { margin:0; font-family: Arial, sans-serif; background:#f3f3f3; color:#222; }
  header { background:var(--brand); color:#fff; text-align:center; padding:10px 12px; }
  header img { max-height:60px; display:block; margin:0 auto 6px; }
  nav { display:flex; background:var(--brand-dark); }
  nav button { flex:1; padding:12px 10px; border:0; background:var(--brand-dark); color:#fff; font-size:16px; cursor:pointer; }
  nav button.active { background:var(--brand-darker); }
  .page { display:none; padding:14px; }
  .page.active { display:block; }

  /* Home */
  .products { display:flex; flex-wrap:wrap; gap:10px; }
  .prod-btn {
    flex:1 0 23%;
    min-width:140px;
    padding:16px 12px;
    border:0; border-radius:6px;
    color:#fff; font-weight:bold; font-size:16px; cursor:pointer;
    box-shadow:0 1px 2px rgba(0,0,0,.1);
  }
  .prod-caption { display:block; font-size:12px; opacity:.9; margin-top:6px; }
  .cart { background:#fff; margin-top:14px; padding:12px; border-radius:8px; box-shadow:0 1px 2px rgba(0,0,0,.06); }
  .cart table { width:100%; border-collapse:collapse; }
  .cart th,.cart td { border-bottom:1px solid #eee; padding:8px; text-align:center; }
  .cart td:first-child,.cart th:first-child { text-align:left; }
  .cart .rmv { padding:4px 10px; border:0; border-radius:4px; cursor:pointer; }
  .total { text-align:right; font-size:18px; font-weight:bold; margin-top:8px; }
  .print { width:100%; margin-top:10px; padding:12px; border:0; border-radius:6px; background:var(--ok); color:#fff; font-size:16px; cursor:pointer; }

  /* Settings */
  .panel { background:#fff; padding:12px; border-radius:8px; box-shadow:0 1px 2px rgba(0,0,0,.06); margin-bottom:14px; }
  .row { display:grid; grid-template-columns: repeat(2, 1fr); gap:10px; }
  .row-3 { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; }
  .row-4 { display:grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap:10px; }
  input, select { width:100%; padding:8px; border:1px solid #ddd; border-radius:6px; }
  .btn { padding:9px 12px; border:0; border-radius:6px; background:var(--brand); color:#fff; cursor:pointer; }
  .btn-ghost { padding:6px 10px; border:1px solid #ddd; border-radius:6px; background:#fff; cursor:pointer; }
  ul { list-style:none; padding:0; margin:8px 0 0; }
  li.item { display:flex; align-items:center; justify-content:space-between; padding:8px; border:1px solid #eee; border-radius:6px; margin-bottom:6px; background:#fafafa; }
  .tag { font-size:12px; padding:2px 6px; border-radius:999px; border:1px solid #ddd; background:#fff; margin-left:6px; }
  .muted { opacity:.7; }

  /* History */
  #historyTable { width:100%; border-collapse:collapse; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 1px 2px rgba(0,0,0,.06); }
  #historyTable th,#historyTable td { border-bottom:1px solid #eee; padding:8px; text-align:left; }
  .actions { display:flex; gap:8px; align-items:center; }

  /* Print */
  @media print {
    body { background:#fff; }
  }
</style>
</head>
<body>
  <header>
    const logoHTML = document.getElementById('logo-container').innerHTML;
printWindow.document.write('<div style="text-align:center;">' + logoHTML + '</div>');
	<div id="logo-container" style="text-align:center; margin-bottom:10px;">
    	<!-- Logo SVG inline -->
   	  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="75px" height="80px" viewBox="0 0 75 79" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 53.414062 0.0507812 C 48.34375 0.09375 34.019531 0.277344 32.449219 0.320312 C 31.914062 0.332031 30.691406 0.355469 29.726562 0.371094 C 28.769531 0.386719 27.152344 0.40625 26.132812 0.417969 C 23.289062 0.460938 16.007812 0.621094 14.003906 0.691406 C 13.234375 0.714844 12.191406 0.75 11.679688 0.765625 C 9.535156 0.828125 7.792969 0.890625 7.511719 0.914062 C 7.347656 0.921875 6.71875 0.949219 6.113281 0.960938 C 4.28125 1.007812 3.863281 1.070312 3.183594 1.40625 C 1.65625 2.167969 0.644531 3.785156 0.449219 5.800781 C 0.410156 6.203125 0.453125 8.355469 0.523438 9.480469 C 0.535156 9.710938 0.570312 10.742188 0.597656 11.777344 C 0.628906 12.808594 0.675781 14.25 0.699219 14.984375 C 0.722656 15.714844 0.769531 17.4375 0.796875 18.8125 C 0.828125 20.183594 0.875 22.335938 0.898438 23.601562 C 1.058594 30.804688 0.988281 41.730469 0.75 48.484375 C 0.71875 49.261719 0.664062 50.847656 0.625 52.015625 C 0.585938 53.183594 0.527344 54.636719 0.5 55.25 C 0.445312 56.425781 0.34375 58.800781 0.226562 61.742188 C 0.183594 62.722656 0.140625 63.742188 0.125 64.015625 C 0.0390625 65.53125 0.00390625 66.9375 0.0507812 67.402344 C 0.214844 69.289062 1.128906 70.953125 2.472656 71.835938 C 2.835938 72.078125 2.929688 72.121094 3.417969 72.320312 C 4.101562 72.585938 4.96875 72.636719 10.734375 72.730469 C 18.53125 72.847656 21.3125 72.84375 28.753906 72.675781 C 33.082031 72.578125 32.90625 72.554688 27.96875 72.578125 L 23.113281 72.597656 L 23.113281 70.457031 L 23.484375 70.457031 C 23.683594 70.457031 23.917969 70.441406 24 70.429688 C 24.140625 70.398438 24.152344 70.382812 24.144531 70.191406 C 24.136719 69.988281 24.136719 69.988281 24.324219 69.972656 C 24.511719 69.960938 24.511719 69.953125 24.511719 69.738281 L 24.511719 69.519531 L 25.394531 69.519531 L 25.433594 67.628906 C 25.453125 66.59375 25.480469 65.652344 25.488281 65.546875 C 25.496094 65.4375 25.503906 65.007812 25.503906 64.585938 L 25.507812 63.828125 L 26.421875 63.863281 C 26.921875 63.875 27.761719 63.90625 28.28125 63.921875 C 28.804688 63.941406 29.234375 63.957031 29.238281 63.960938 C 29.269531 63.984375 29.402344 65.707031 29.429688 66.433594 C 29.449219 66.894531 29.46875 67.351562 29.476562 67.445312 C 29.488281 67.539062 29.496094 68.046875 29.496094 68.566406 L 29.503906 69.519531 L 31.839844 69.519531 L 31.867188 68.566406 C 31.882812 68.046875 31.917969 66.222656 31.949219 64.511719 C 31.984375 62.804688 32.015625 61.265625 32.023438 61.082031 C 32.035156 60.902344 32.058594 59.886719 32.074219 58.820312 L 32.109375 56.886719 L 31.949219 56.910156 C 31.753906 56.945312 31.695312 56.894531 31.5 56.554688 C 31.359375 56.308594 31.351562 56.253906 31.351562 55.796875 C 31.351562 55.527344 31.375 55.246094 31.410156 55.175781 C 31.460938 55.0625 31.496094 55.054688 31.757812 55.054688 L 32.046875 55.054688 L 32.039062 54.105469 L 32.023438 53.15625 L 31.300781 52.941406 C 30.902344 52.820312 30.554688 52.707031 30.535156 52.683594 C 30.511719 52.664062 30.527344 52.539062 30.566406 52.40625 L 30.636719 52.164062 L 31.46875 52.148438 L 32.296875 52.140625 L 32.296875 50.660156 L 23.664062 50.660156 L 23.664062 52.289062 L 21.984375 52.289062 L 21.988281 52.472656 C 21.988281 52.671875 21.898438 52.628906 22.898438 52.929688 L 23.414062 53.082031 L 23.414062 55.203125 L 22.953125 55.203125 L 22.488281 55.207031 L 22.628906 55.324219 C 22.742188 55.429688 22.761719 55.484375 22.761719 55.71875 C 22.761719 55.867188 22.742188 55.992188 22.714844 55.992188 C 22.6875 55.992188 22.664062 56.046875 22.664062 56.113281 C 22.664062 56.21875 22.6875 56.238281 22.8125 56.238281 C 22.964844 56.238281 22.964844 56.242188 22.964844 56.507812 L 22.964844 56.78125 L 23.414062 56.78125 L 23.414062 62.460938 L 12.78125 62.460938 L 12.789062 56.152344 L 12.804688 49.847656 L 13.078125 49.695312 C 13.3125 49.566406 13.355469 49.523438 13.367188 49.386719 L 13.382812 49.226562 L 12.179688 49.226562 L 12.179688 34.90625 L 11.957031 34.90625 C 11.730469 34.90625 11.730469 34.90625 11.730469 34.734375 C 11.730469 34.5625 11.636719 34.320312 11.507812 34.167969 C 11.386719 34.023438 11.386719 33.929688 11.507812 33.773438 C 11.6875 33.53125 11.707031 33.359375 11.585938 33.125 C 11.480469 32.933594 11.480469 32.878906 11.480469 29.75 C 11.480469 26.597656 11.480469 26.5625 11.582031 26.5625 C 11.730469 26.5625 11.726562 26.242188 11.578125 26.203125 C 11.488281 26.179688 11.476562 26.152344 11.511719 25.9375 C 11.550781 25.648438 11.652344 25.363281 11.78125 25.148438 C 11.871094 25 11.871094 24.984375 11.792969 24.984375 C 11.710938 24.984375 11.09375 25.085938 10.742188 25.160156 C 10.582031 25.195312 10.574219 25.191406 10.582031 25.054688 C 10.613281 24.652344 10.582031 24.390625 10.507812 24.390625 C 10.449219 24.390625 10.433594 24.320312 10.433594 24.070312 C 10.433594 23.886719 10.453125 23.75 10.484375 23.75 C 10.511719 23.75 10.53125 23.714844 10.53125 23.671875 C 10.53125 23.632812 10.507812 23.609375 10.484375 23.625 C 10.449219 23.644531 10.433594 22.910156 10.433594 21.453125 C 10.433594 19.492188 10.441406 19.25 10.507812 19.265625 C 10.578125 19.28125 10.589844 19.078125 10.589844 17.480469 C 10.589844 16.3125 10.574219 15.585938 10.53125 15.429688 C 10.34375 14.601562 9.542969 13.828125 8.636719 13.597656 C 8.371094 13.535156 8.273438 13.527344 8.015625 13.578125 C 7.042969 13.765625 6.183594 14.574219 5.992188 15.492188 C 5.960938 15.632812 5.945312 16.453125 5.949219 17.503906 C 5.964844 19.042969 5.976562 19.28125 6.039062 19.28125 C 6.105469 19.28125 6.113281 19.558594 6.113281 21.453125 C 6.113281 23.167969 6.101562 23.621094 6.054688 23.609375 C 6.019531 23.605469 5.992188 23.636719 5.992188 23.675781 C 5.992188 23.714844 6.019531 23.75 6.058594 23.75 C 6.113281 23.75 6.128906 23.824219 6.125 24.082031 C 6.113281 24.371094 6.105469 24.414062 6.023438 24.402344 C 5.949219 24.386719 5.941406 24.4375 5.941406 24.792969 C 5.941406 25.179688 5.933594 25.191406 5.824219 25.160156 C 5.609375 25.105469 4.738281 24.972656 4.71875 24.992188 C 4.707031 25.003906 4.753906 25.121094 4.816406 25.261719 C 4.945312 25.53125 5.035156 25.867188 5.042969 26.078125 C 5.042969 26.183594 5.015625 26.21875 4.941406 26.21875 C 4.863281 26.21875 4.84375 26.253906 4.84375 26.390625 C 4.84375 26.527344 4.863281 26.5625 4.941406 26.5625 C 5.042969 26.5625 5.042969 26.597656 5.042969 29.761719 C 5.042969 32.804688 5.035156 32.972656 4.945312 33.144531 C 4.832031 33.367188 4.871094 33.621094 5.046875 33.808594 C 5.160156 33.925781 5.167969 33.925781 5.070312 34.082031 C 5.023438 34.171875 4.9375 34.316406 4.886719 34.40625 C 4.832031 34.492188 4.792969 34.640625 4.792969 34.734375 C 4.792969 34.90625 4.792969 34.90625 4.566406 34.90625 L 4.34375 34.90625 L 4.34375 42.050781 L 4.347656 49.203125 L 3.742188 49.21875 L 3.144531 49.230469 L 3.144531 49.375 C 3.144531 49.5 3.183594 49.542969 3.433594 49.6875 L 3.71875 49.847656 L 3.734375 56.152344 L 3.742188 62.460938 L 3.246094 62.460938 L 3.238281 63.285156 C 3.230469 64.03125 3.226562 64.074219 3.191406 63.695312 C 3.171875 63.460938 3.121094 62.339844 3.074219 61.199219 C 3.03125 60.058594 2.984375 58.96875 2.96875 58.78125 C 2.933594 58.347656 2.765625 54.128906 2.671875 51.300781 C 2.628906 50.121094 2.574219 48.539062 2.546875 47.796875 C 2.421875 44.347656 2.371094 40.414062 2.371094 33.550781 C 2.371094 29.554688 2.390625 25.289062 2.410156 24.070312 C 2.484375 19.839844 2.546875 17.109375 2.570312 16.863281 C 2.582031 16.722656 2.605469 15.984375 2.621094 15.207031 C 2.65625 13.484375 2.734375 10.925781 2.769531 10.394531 C 2.785156 10.175781 2.820312 9.1875 2.851562 8.195312 C 2.890625 6.777344 2.921875 6.296875 2.996094 5.933594 C 3.179688 5.066406 3.679688 4.28125 4.242188 4 C 4.46875 3.886719 4.476562 3.886719 5.839844 3.921875 C 7.375 3.960938 9.476562 4.027344 10.308594 4.074219 C 10.851562 4.101562 14.378906 4.203125 17.972656 4.296875 C 19 4.320312 21.144531 4.363281 22.738281 4.394531 C 24.332031 4.417969 25.992188 4.453125 26.433594 4.46875 C 26.871094 4.484375 28.300781 4.503906 29.601562 4.519531 C 32.375 4.550781 37.445312 4.625 39.335938 4.664062 C 40.066406 4.679688 42.960938 4.714844 45.777344 4.738281 C 48.59375 4.765625 51.34375 4.804688 51.890625 4.820312 C 52.441406 4.839844 56.632812 4.855469 61.210938 4.859375 L 69.535156 4.863281 L 69.664062 4.988281 C 69.90625 5.210938 70.15625 5.8125 70.207031 6.28125 C 70.222656 6.421875 70.246094 7.289062 70.261719 8.195312 C 70.277344 9.105469 70.296875 10.472656 70.3125 11.234375 C 70.328125 11.992188 70.363281 13.851562 70.386719 15.355469 C 70.417969 16.863281 70.449219 18.273438 70.460938 18.492188 C 70.476562 18.707031 70.515625 19.929688 70.5625 21.207031 C 70.601562 22.480469 70.648438 23.714844 70.660156 23.945312 C 70.675781 24.179688 70.722656 25.167969 70.761719 26.144531 C 70.800781 27.121094 70.855469 28.296875 70.886719 28.761719 C 70.917969 29.21875 70.972656 30.277344 71.015625 31.105469 C 71.160156 34 71.234375 35.382812 71.261719 35.699219 C 71.277344 35.875 71.320312 36.660156 71.359375 37.449219 C 71.40625 38.234375 71.480469 39.648438 71.535156 40.585938 C 71.589844 41.523438 71.671875 42.957031 71.710938 43.769531 C 71.75 44.585938 71.804688 45.617188 71.828125 46.066406 C 71.859375 46.515625 71.90625 47.46875 71.933594 48.191406 C 71.964844 48.910156 71.996094 49.675781 72.011719 49.886719 C 72.039062 50.382812 72.121094 52.480469 72.160156 53.867188 C 72.175781 54.449219 72.210938 55.472656 72.234375 56.140625 C 72.257812 56.804688 72.292969 58.5 72.3125 59.902344 L 72.347656 62.460938 L 62.398438 62.460938 L 62.398438 56.785156 L 62.613281 56.769531 L 62.824219 56.757812 L 62.824219 56.238281 L 62.988281 56.238281 C 63.125 56.238281 63.148438 56.21875 63.148438 56.121094 C 63.148438 56.054688 63.125 55.992188 63.09375 55.980469 C 63.058594 55.972656 63.035156 55.859375 63.035156 55.730469 C 63.035156 55.535156 63.058594 55.464844 63.175781 55.347656 L 63.320312 55.203125 L 62.398438 55.203125 L 62.410156 54.128906 L 62.425781 53.0625 L 62.550781 53.023438 C 62.621094 53.003906 62.820312 52.945312 63 52.890625 C 63.179688 52.835938 63.429688 52.765625 63.5625 52.734375 C 63.792969 52.671875 63.796875 52.664062 63.796875 52.480469 L 63.796875 52.289062 L 62.152344 52.289062 L 62.152344 50.660156 L 53.660156 50.660156 L 53.675781 51.308594 L 53.6875 51.96875 L 55.28125 51.96875 L 55.394531 52.335938 C 55.460938 52.539062 55.511719 52.734375 55.511719 52.765625 C 55.511719 52.800781 55.425781 52.851562 55.328125 52.875 C 55.222656 52.90625 54.863281 53.015625 54.527344 53.113281 L 53.914062 53.300781 L 53.914062 53.773438 C 53.914062 54.035156 53.929688 54.386719 53.945312 54.554688 L 53.980469 54.855469 L 54.214844 54.855469 C 54.441406 54.855469 54.453125 54.859375 54.53125 55.054688 C 54.585938 55.195312 54.613281 55.414062 54.613281 55.804688 L 54.613281 56.351562 L 54.402344 56.710938 C 54.207031 57.046875 54.171875 57.078125 54.027344 57.078125 L 53.863281 57.078125 L 53.863281 57.460938 C 53.863281 58.28125 53.964844 66.175781 53.992188 67.777344 L 54.023438 69.46875 L 56.046875 69.46875 L 56.105469 66.667969 C 56.140625 65.125 56.183594 63.851562 56.203125 63.832031 C 56.21875 63.8125 56.765625 63.816406 57.40625 63.84375 C 60.761719 63.96875 60.792969 64.015625 57.574219 64.117188 L 56.558594 64.152344 L 56.558594 64.800781 C 56.558594 65.574219 56.644531 68.257812 56.6875 68.960938 L 56.71875 69.46875 L 59.027344 69.480469 L 61.328125 69.496094 L 61.34375 69.726562 C 61.355469 69.960938 61.363281 69.964844 61.53125 69.964844 C 61.703125 69.964844 61.703125 69.964844 61.703125 70.1875 L 61.703125 70.410156 L 62.699219 70.410156 L 62.699219 71.148438 L 63.414062 71.144531 C 63.804688 71.140625 64.515625 71.125 64.996094 71.105469 C 65.785156 71.082031 65.835938 71.070312 65.53125 71.035156 L 65.191406 70.992188 L 65.214844 70.839844 C 65.230469 70.75 65.253906 69.730469 65.277344 68.570312 C 65.304688 66.738281 65.300781 66.457031 65.242188 66.433594 C 65.179688 66.410156 65.171875 66.339844 65.199219 66.058594 C 65.277344 65.402344 65.511719 64.914062 65.96875 64.492188 C 66.304688 64.183594 66.511719 64.058594 66.941406 63.910156 C 67.300781 63.792969 68.050781 63.789062 68.441406 63.90625 C 69.328125 64.175781 69.976562 64.902344 70.109375 65.765625 C 70.167969 66.167969 70.328125 68.699219 70.367188 69.925781 L 70.398438 70.851562 L 72.480469 70.851562 L 72.5 69.628906 C 72.515625 68.484375 72.523438 68.375 72.652344 67.890625 L 72.792969 67.371094 L 72.832031 63.472656 C 72.859375 61.324219 72.886719 59.214844 72.902344 58.78125 C 72.921875 58.347656 72.957031 57.113281 72.984375 56.039062 C 73.042969 53.632812 73.078125 52.472656 73.109375 51.992188 C 73.121094 51.789062 73.152344 51 73.183594 50.238281 C 73.210938 49.480469 73.269531 48.210938 73.308594 47.425781 C 73.347656 46.632812 73.390625 45.703125 73.40625 45.351562 C 73.421875 44.996094 73.457031 44.355469 73.488281 43.917969 C 73.511719 43.484375 73.566406 42.515625 73.613281 41.769531 C 73.71875 39.796875 73.867188 37.160156 73.980469 35.15625 C 74.035156 34.191406 74.113281 32.699219 74.15625 31.847656 C 74.195312 30.992188 74.242188 30.148438 74.257812 29.96875 C 74.296875 29.472656 74.472656 25.773438 74.582031 22.984375 C 74.769531 18.199219 74.925781 11.675781 74.941406 7.824219 L 74.945312 5.652344 L 74.808594 5.015625 C 74.5 3.535156 73.882812 2.40625 72.878906 1.460938 C 72.113281 0.75 71.226562 0.292969 70.277344 0.128906 C 69.742188 0.0351562 60.222656 -0.0117188 53.414062 0.0507812 Z M 10.144531 18.984375 L 10.277344 19.019531 L 10.253906 19.59375 C 10.242188 19.914062 10.207031 20.871094 10.179688 21.726562 C 10.152344 22.578125 10.117188 23.363281 10.097656 23.46875 L 10.070312 23.65625 L 9.664062 23.644531 C 9.445312 23.640625 9.226562 23.625 9.179688 23.617188 C 9.089844 23.589844 9.089844 23.570312 8.925781 22.292969 L 8.859375 21.800781 L 8.832031 22.539062 C 8.8125 22.945312 8.796875 23.363281 8.789062 23.46875 L 8.785156 23.65625 L 8.363281 23.644531 C 8.128906 23.636719 7.914062 23.617188 7.882812 23.601562 C 7.8125 23.558594 7.699219 22.859375 7.644531 22.1875 C 7.613281 21.804688 7.597656 21.730469 7.59375 21.921875 C 7.582031 22.070312 7.574219 22.234375 7.5625 22.28125 C 7.554688 22.335938 7.539062 22.664062 7.53125 23.019531 L 7.519531 23.660156 L 7.035156 23.640625 C 6.765625 23.636719 6.535156 23.617188 6.523438 23.601562 C 6.480469 23.558594 6.339844 22.457031 6.296875 21.824219 C 6.273438 21.484375 6.25 20.691406 6.246094 20.066406 L 6.234375 18.925781 L 8.121094 18.933594 C 9.160156 18.941406 10.070312 18.964844 10.144531 18.984375 Z M 8.210938 25.527344 C 9.15625 25.601562 9.476562 25.648438 10.042969 25.828125 C 10.558594 25.992188 10.933594 26.238281 10.933594 26.421875 C 10.933594 26.539062 10.871094 26.539062 10.796875 26.421875 C 10.601562 26.113281 9.136719 25.925781 8.039062 26.066406 C 7.859375 26.089844 7.476562 26.132812 7.1875 26.167969 C 6.425781 26.253906 5.941406 26.351562 5.839844 26.441406 C 5.722656 26.550781 5.691406 26.535156 5.691406 26.371094 C 5.691406 26.054688 6.324219 25.679688 7.089844 25.550781 C 7.292969 25.515625 7.472656 25.488281 7.488281 25.484375 C 7.503906 25.484375 7.828125 25.503906 8.210938 25.527344 Z M 8.921875 29.011719 C 9.179688 29.136719 9.390625 29.347656 9.566406 29.675781 C 9.640625 29.8125 9.660156 29.949219 9.660156 30.390625 C 9.660156 31.007812 9.613281 31.136719 9.265625 31.492188 C 8.976562 31.792969 8.691406 31.914062 8.28125 31.910156 C 7.128906 31.894531 6.464844 30.695312 7.007812 29.628906 C 7.203125 29.257812 7.578125 28.988281 8.0625 28.863281 C 8.25 28.820312 8.660156 28.890625 8.921875 29.011719 Z M 9.011719 40.039062 C 9.234375 40.160156 9.386719 40.414062 9.386719 40.664062 C 9.386719 41.050781 9.289062 41.125 9.082031 40.902344 C 9.015625 40.832031 8.859375 40.703125 8.734375 40.621094 C 8.554688 40.496094 8.460938 40.460938 8.25 40.460938 C 7.949219 40.460938 7.761719 40.570312 7.613281 40.847656 C 7.484375 41.078125 7.4375 41.078125 7.4375 40.839844 C 7.4375 40.578125 7.496094 40.4375 7.691406 40.246094 C 8.023438 39.914062 8.621094 39.824219 9.011719 40.039062 Z M 9.570312 42.398438 C 9.539062 43.292969 9.421875 44.601562 9.339844 44.90625 L 9.304688 45.054688 L 8.355469 45.113281 C 7.835938 45.144531 7.398438 45.152344 7.378906 45.136719 C 7.332031 45.09375 7.214844 41.632812 7.253906 41.59375 C 7.308594 41.539062 8.023438 41.488281 8.804688 41.480469 L 9.601562 41.476562 Z M 8.875 53.320312 C 9.140625 53.453125 9.378906 53.699219 9.488281 53.941406 C 9.640625 54.277344 9.804688 55.992188 9.863281 57.804688 L 9.898438 58.945312 L 9.691406 58.976562 C 9.496094 59.007812 8.632812 58.988281 7.441406 58.925781 L 6.925781 58.894531 L 6.96875 57.476562 C 7.007812 56.167969 7.007812 55.359375 6.980469 54.484375 C 6.96875 54.222656 6.988281 54.09375 7.0625 53.941406 C 7.308594 53.453125 7.828125 53.15625 8.371094 53.195312 C 8.542969 53.210938 8.769531 53.265625 8.875 53.320312 Z M 18.980469 63.847656 C 19.6875 63.996094 20.335938 64.484375 20.640625 65.097656 C 20.851562 65.515625 20.890625 65.738281 20.964844 66.804688 C 20.996094 67.253906 21.042969 67.921875 21.066406 68.285156 C 21.089844 68.652344 21.125 69.4375 21.144531 70.027344 L 21.179688 71.105469 L 18.816406 71.082031 C 16.363281 71.054688 15.949219 71.035156 15.996094 70.921875 C 16.007812 70.886719 16.035156 69.878906 16.054688 68.6875 C 16.085938 66.765625 16.078125 66.507812 16.015625 66.507812 C 15.925781 66.507812 15.941406 66.15625 16.058594 65.695312 C 16.378906 64.414062 17.695312 63.582031 18.980469 63.847656 Z M 18.980469 63.847656 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 6.914062 19.5625 C 6.902344 19.597656 6.882812 20.105469 6.867188 20.6875 C 6.84375 21.660156 6.746094 22.945312 6.660156 23.339844 L 6.628906 23.503906 L 7.328125 23.503906 L 7.308594 23.316406 C 7.289062 23.136719 7.1875 20.105469 7.1875 19.699219 C 7.1875 19.523438 7.179688 19.503906 7.0625 19.503906 C 6.992188 19.503906 6.929688 19.53125 6.914062 19.5625 Z M 6.914062 19.5625 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 8.222656 20.410156 C 8.167969 21.804688 8.058594 23.097656 7.957031 23.414062 C 7.933594 23.492188 7.96875 23.503906 8.257812 23.503906 L 8.585938 23.503906 L 8.585938 23.289062 C 8.585938 23.175781 8.566406 22.550781 8.535156 21.898438 C 8.421875 19.355469 8.4375 19.503906 8.339844 19.503906 C 8.261719 19.503906 8.246094 19.59375 8.222656 20.410156 Z M 8.222656 20.410156 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 9.484375 20.179688 C 9.484375 21.042969 9.398438 22.351562 9.308594 22.96875 C 9.269531 23.234375 9.234375 23.464844 9.234375 23.476562 C 9.234375 23.492188 9.394531 23.503906 9.589844 23.503906 L 9.945312 23.503906 L 9.917969 23.265625 C 9.902344 23.136719 9.863281 22.238281 9.828125 21.265625 L 9.765625 19.503906 L 9.484375 19.503906 Z M 9.484375 20.179688 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 7.988281 29.582031 C 7.558594 29.773438 7.339844 30.089844 7.339844 30.515625 C 7.339844 31.027344 7.671875 31.4375 8.191406 31.550781 C 8.894531 31.703125 9.578125 31.191406 9.585938 30.5 C 9.585938 29.941406 9.082031 29.476562 8.460938 29.476562 C 8.316406 29.476562 8.117188 29.519531 7.988281 29.582031 Z M 7.988281 29.582031 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 7.71875 42.574219 C 7.703125 42.851562 7.675781 43.484375 7.664062 43.976562 L 7.636719 44.875 L 7.847656 44.902344 C 8.339844 44.960938 9.183594 44.972656 9.183594 44.910156 C 9.183594 44.882812 9.148438 44.664062 9.109375 44.425781 C 9.074219 44.195312 9.015625 43.582031 8.980469 43.070312 C 8.949219 42.5625 8.921875 42.136719 8.914062 42.136719 C 8.914062 42.132812 8.652344 42.117188 8.328125 42.101562 L 7.746094 42.078125 Z M 7.71875 42.574219 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 9.238281 55.464844 C 9.171875 55.542969 8.996094 55.664062 8.847656 55.734375 C 8.625 55.832031 8.519531 55.851562 8.246094 55.832031 C 7.921875 55.820312 7.511719 55.664062 7.429688 55.53125 C 7.40625 55.503906 7.382812 55.488281 7.375 55.496094 C 7.351562 55.523438 7.429688 58.371094 7.449219 58.382812 C 7.457031 58.386719 7.863281 58.371094 8.351562 58.347656 L 9.234375 58.296875 L 9.234375 57.832031 C 9.234375 57.582031 9.269531 56.925781 9.316406 56.382812 C 9.355469 55.839844 9.386719 55.375 9.375 55.355469 C 9.363281 55.335938 9.304688 55.382812 9.238281 55.464844 Z M 9.238281 55.464844 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 17.996094 64.285156 C 17.828125 64.339844 17.570312 64.464844 17.421875 64.566406 C 17.117188 64.78125 16.757812 65.265625 16.671875 65.574219 C 16.644531 65.683594 16.601562 65.808594 16.589844 65.847656 C 16.570312 65.90625 16.691406 65.914062 17.421875 65.914062 C 17.890625 65.914062 18.539062 65.933594 18.859375 65.964844 C 19.179688 65.988281 19.742188 66.019531 20.109375 66.023438 L 20.773438 66.039062 L 20.742188 65.867188 C 20.695312 65.609375 20.425781 65.089844 20.234375 64.875 C 19.699219 64.292969 18.765625 64.042969 17.996094 64.285156 Z M 17.996094 64.285156 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 20.066406 66.390625 C 19.503906 66.464844 17.597656 66.566406 16.921875 66.550781 L 16.449219 66.546875 L 16.457031 67.105469 C 16.464844 67.417969 16.484375 68.300781 16.503906 69.074219 L 16.535156 70.484375 L 18.511719 70.46875 C 19.597656 70.457031 20.503906 70.4375 20.515625 70.429688 C 20.53125 70.414062 20.558594 69.929688 20.578125 69.355469 C 20.605469 68.382812 20.683594 67.175781 20.746094 66.566406 C 20.777344 66.265625 20.832031 66.28125 20.066406 66.390625 Z M 20.066406 66.390625 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 8.160156 11.664062 C 8.148438 11.695312 8.140625 11.816406 8.152344 11.925781 C 8.160156 12.097656 8.148438 12.121094 8.050781 12.136719 C 7.976562 12.144531 7.9375 12.1875 7.9375 12.246094 C 7.9375 12.304688 7.976562 12.34375 8.050781 12.355469 C 8.15625 12.367188 8.160156 12.382812 8.15625 12.898438 L 8.152344 13.429688 L 8.441406 13.429688 L 8.429688 12.898438 C 8.417969 12.382812 8.421875 12.367188 8.527344 12.355469 C 8.675781 12.328125 8.675781 12.15625 8.527344 12.136719 C 8.421875 12.121094 8.410156 12.097656 8.425781 11.859375 C 8.441406 11.613281 8.441406 11.601562 8.3125 11.601562 C 8.242188 11.601562 8.171875 11.632812 8.160156 11.664062 Z M 8.160156 11.664062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 42.78125 33.746094 C 42.78125 34.003906 42.777344 34.019531 42.65625 34.019531 C 42.558594 34.019531 42.53125 34.042969 42.53125 34.144531 C 42.53125 34.242188 42.558594 34.265625 42.65625 34.265625 L 42.78125 34.265625 L 42.78125 35.304688 L 42.28125 35.304688 L 42.28125 35.949219 L 42.097656 36.027344 C 41.804688 36.152344 39.941406 36.90625 39.085938 37.253906 C 38.125 37.636719 38.148438 37.628906 37.640625 37.839844 C 37.40625 37.933594 36.765625 38.195312 36.21875 38.414062 C 35.023438 38.894531 34.578125 39.074219 34.144531 39.257812 C 33.113281 39.691406 32.160156 40.046875 32.003906 40.058594 L 31.824219 40.066406 L 31.792969 39.449219 L 33.453125 39.449219 L 33.4375 39.203125 C 33.425781 39.066406 33.40625 38.957031 33.386719 38.957031 C 33.363281 38.957031 32.503906 38.957031 31.476562 38.957031 L 29.601562 38.957031 L 29.601562 39.449219 L 31.199219 39.449219 L 31.199219 39.777344 C 31.199219 40.082031 31.195312 40.097656 31.089844 40.09375 C 30.746094 40.0625 30.726562 40.078125 30.730469 40.324219 L 30.734375 40.5625 L 30.96875 40.578125 L 31.199219 40.589844 L 31.199219 43.648438 L 31.800781 43.648438 L 31.800781 40.585938 L 32.351562 40.585938 L 32.339844 40.890625 C 32.324219 41.171875 32.3125 41.203125 32.214844 41.207031 C 31.878906 41.226562 31.898438 41.214844 31.898438 41.476562 L 31.898438 41.722656 L 32.347656 41.722656 L 32.347656 44.78125 L 32.847656 44.78125 L 32.824219 48.757812 L 32.199219 48.757812 L 32.199219 49.078125 L 32.847656 49.078125 L 32.847656 50.515625 L 36.78125 50.492188 C 38.941406 50.472656 41.707031 50.453125 42.929688 50.4375 C 44.15625 50.421875 46.910156 50.398438 49.0625 50.382812 L 52.964844 50.347656 L 52.964844 49.078125 L 53.621094 49.078125 L 53.605469 48.925781 L 53.589844 48.769531 L 52.964844 48.769531 L 52.964844 41.917969 L 53.265625 41.917969 L 53.265625 40.339844 L 53.570312 40.339844 C 53.847656 40.339844 53.867188 40.328125 53.855469 40.234375 C 53.84375 40.167969 53.769531 40.101562 53.613281 40.042969 C 53.488281 40 53.199219 39.878906 52.964844 39.785156 C 52.730469 39.6875 52.125 39.441406 51.617188 39.238281 C 51.109375 39.03125 50.226562 38.671875 49.644531 38.4375 C 49.070312 38.203125 48.273438 37.878906 47.875 37.722656 C 47.472656 37.558594 46.980469 37.363281 46.773438 37.277344 C 45.976562 36.949219 43.613281 35.996094 43.59375 35.996094 C 43.585938 35.996094 43.582031 35.835938 43.582031 35.648438 L 43.582031 35.304688 L 43.03125 35.304688 L 43.03125 34.265625 L 43.15625 34.265625 C 43.253906 34.265625 43.28125 34.242188 43.28125 34.144531 C 43.28125 34.042969 43.253906 34.019531 43.15625 34.019531 C 43.035156 34.019531 43.03125 34.003906 43.03125 33.746094 C 43.03125 33.492188 43.027344 33.476562 42.90625 33.476562 C 42.785156 33.476562 42.78125 33.492188 42.78125 33.746094 Z M 42.683594 42.269531 C 42.683594 42.433594 42.667969 42.46875 42.597656 42.453125 C 42.53125 42.441406 42.503906 42.382812 42.492188 42.25 C 42.476562 42.09375 42.492188 42.066406 42.578125 42.066406 C 42.667969 42.066406 42.683594 42.097656 42.683594 42.269531 Z M 41.519531 42.742188 C 41.503906 42.753906 41.410156 42.710938 41.308594 42.636719 C 41.203125 42.566406 41.09375 42.511719 41.058594 42.511719 C 40.964844 42.511719 40.925781 42.363281 41.007812 42.335938 C 41.050781 42.320312 41.179688 42.273438 41.292969 42.242188 L 41.507812 42.179688 L 41.523438 42.449219 C 41.535156 42.601562 41.527344 42.730469 41.519531 42.742188 Z M 44.285156 42.226562 C 44.394531 42.253906 44.480469 42.308594 44.480469 42.339844 C 44.480469 42.414062 44.375 42.710938 44.355469 42.710938 C 44.199219 42.710938 43.828125 42.585938 43.828125 42.535156 C 43.828125 42.503906 43.800781 42.460938 43.769531 42.453125 C 43.71875 42.433594 43.71875 42.402344 43.765625 42.300781 C 43.835938 42.148438 43.96875 42.132812 44.285156 42.226562 Z M 45.101562 42.511719 C 45.117188 42.535156 45.109375 42.5625 45.082031 42.5625 C 45.054688 42.5625 45.027344 42.535156 45.027344 42.511719 C 45.027344 42.480469 45.039062 42.460938 45.046875 42.460938 C 45.0625 42.460938 45.085938 42.480469 45.101562 42.511719 Z M 40.398438 42.964844 C 40.421875 43.023438 40.425781 43.085938 40.414062 43.089844 C 40.40625 43.097656 40.304688 43.066406 40.191406 43.011719 C 39.972656 42.917969 39.992188 42.867188 40.242188 42.863281 C 40.335938 42.859375 40.378906 42.886719 40.398438 42.964844 Z M 45.675781 43.023438 L 45.675781 43.199219 L 45.476562 43.113281 C 45.367188 43.070312 45.277344 43.015625 45.277344 43 C 45.277344 42.972656 45.523438 42.871094 45.617188 42.863281 C 45.652344 42.859375 45.675781 42.921875 45.675781 43.023438 Z M 46.503906 43.277344 C 46.644531 43.394531 46.738281 43.519531 46.773438 43.636719 C 46.875 44 46.851562 44.011719 46.527344 43.761719 C 46.242188 43.542969 46.226562 43.523438 46.226562 43.316406 C 46.226562 43.203125 46.242188 43.105469 46.257812 43.105469 C 46.277344 43.105469 46.386719 43.183594 46.503906 43.277344 Z M 39.890625 43.449219 C 39.964844 43.449219 39.941406 43.535156 39.851562 43.570312 C 39.804688 43.589844 39.75 43.574219 39.726562 43.539062 C 39.667969 43.433594 39.679688 43.386719 39.765625 43.421875 C 39.8125 43.433594 39.867188 43.449219 39.890625 43.449219 Z M 39.226562 43.839844 L 39.308594 44.007812 L 39.097656 44.199219 C 38.871094 44.40625 38.828125 44.40625 38.601562 44.191406 C 38.382812 43.988281 38.488281 43.804688 38.960938 43.589844 C 39.09375 43.527344 39.113281 43.527344 39.128906 43.597656 C 39.136719 43.636719 39.183594 43.746094 39.226562 43.839844 Z M 47.808594 44.660156 C 48.269531 45.335938 48.5625 46.082031 48.695312 46.90625 C 48.78125 47.445312 48.796875 47.992188 48.722656 47.992188 C 48.695312 47.992188 48.671875 47.984375 48.671875 47.96875 C 48.671875 47.554688 48.460938 46.496094 48.324219 46.191406 C 48.296875 46.136719 48.21875 45.957031 48.148438 45.796875 C 48.019531 45.492188 47.695312 44.972656 47.488281 44.71875 C 47.414062 44.625 47.375 44.511719 47.375 44.394531 C 47.375 44.058594 47.414062 44.078125 47.808594 44.660156 Z M 38.273438 44.585938 C 38.363281 44.664062 38.464844 44.734375 38.492188 44.734375 C 38.523438 44.734375 38.539062 44.757812 38.527344 44.792969 C 38.511719 44.832031 38.402344 44.847656 38.203125 44.835938 C 37.925781 44.828125 37.894531 44.835938 37.859375 44.941406 C 37.820312 45.070312 37.628906 45.335938 37.605469 45.304688 C 37.566406 45.273438 38.027344 44.4375 38.085938 44.4375 C 38.09375 44.4375 38.179688 44.5 38.273438 44.585938 Z M 37.765625 46.039062 C 37.570312 46.476562 37.390625 47.050781 37.308594 47.523438 C 37.265625 47.765625 37.226562 47.976562 37.214844 47.988281 C 37.207031 47.992188 37.171875 47.988281 37.136719 47.96875 C 37.054688 47.914062 37.109375 46.851562 37.21875 46.371094 L 37.304688 46.011719 L 37.558594 45.894531 C 37.699219 45.828125 37.828125 45.777344 37.847656 45.777344 C 37.871094 45.769531 37.828125 45.890625 37.765625 46.039062 Z M 37.765625 46.039062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 35.285156 55.433594 L 34.644531 55.453125 L 34.644531 56.367188 L 34.363281 56.699219 C 34.195312 56.898438 34.050781 57.027344 33.992188 57.027344 C 33.894531 57.027344 33.890625 57.058594 33.929688 58.445312 C 33.949219 59.230469 33.96875 62.058594 33.96875 64.734375 L 33.96875 69.605469 L 34.945312 69.636719 C 35.476562 69.652344 36.148438 69.683594 36.433594 69.699219 L 36.941406 69.730469 L 36.941406 56.980469 L 36.746094 56.980469 C 36.5625 56.980469 36.546875 56.964844 36.347656 56.636719 C 36.148438 56.300781 36.140625 56.28125 36.140625 55.847656 C 36.140625 55.414062 36.136719 55.398438 36.03125 55.410156 C 35.96875 55.414062 35.632812 55.429688 35.285156 55.433594 Z M 35.285156 55.433594 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 49.671875 55.84375 C 49.671875 56.292969 49.664062 56.300781 49.460938 56.636719 C 49.257812 56.960938 49.234375 56.980469 49.0625 56.980469 L 48.871094 56.980469 L 48.871094 69.730469 L 49.359375 69.699219 C 49.625 69.683594 50.292969 69.652344 50.84375 69.636719 L 51.84375 69.605469 L 51.84375 63.894531 C 51.84375 60.757812 51.863281 57.925781 51.882812 57.605469 C 51.917969 57.054688 51.917969 57.027344 51.820312 57.027344 C 51.765625 57.027344 51.601562 56.890625 51.417969 56.671875 L 51.109375 56.320312 L 51.144531 55.882812 L 51.179688 55.449219 L 50.613281 55.449219 C 50.300781 55.449219 49.960938 55.433594 49.859375 55.417969 L 49.671875 55.382812 Z M 49.671875 55.84375 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 39.535156 55.898438 L 39.535156 56.347656 L 39.238281 56.683594 C 39.007812 56.9375 38.914062 57.011719 38.835938 56.992188 C 38.738281 56.96875 38.738281 57 38.738281 60.050781 C 38.738281 61.75 38.753906 64.601562 38.773438 66.398438 L 38.804688 69.667969 L 40.085938 69.667969 L 40.085938 68.925781 C 40.085938 68.210938 40.128906 66.785156 40.234375 64.238281 C 40.261719 63.570312 40.289062 62.761719 40.296875 62.441406 L 40.300781 61.851562 L 41.527344 61.886719 C 42.203125 61.90625 43.082031 61.941406 43.480469 61.964844 C 43.878906 61.992188 44.390625 62.015625 44.617188 62.015625 C 44.933594 62.015625 45.027344 62.03125 45.027344 62.085938 C 45.027344 62.132812 44.902344 62.15625 44.542969 62.183594 C 43.671875 62.242188 42.074219 62.3125 41.507812 62.3125 C 41.210938 62.3125 40.929688 62.332031 40.890625 62.355469 C 40.808594 62.40625 40.808594 62.238281 40.960938 66.484375 C 41.003906 67.734375 41.050781 68.765625 41.058594 68.773438 C 41.074219 68.785156 41.546875 68.824219 42.117188 68.859375 C 43.03125 68.917969 44.488281 69.074219 44.894531 69.15625 C 45.011719 69.179688 45.09375 69.324219 44.984375 69.324219 C 44.964844 69.324219 44.753906 69.351562 44.523438 69.390625 C 44.09375 69.464844 43.476562 69.535156 42.632812 69.605469 L 42.15625 69.644531 L 43.03125 69.671875 C 43.511719 69.691406 44.632812 69.707031 45.523438 69.710938 C 46.875 69.71875 47.128906 69.707031 47.109375 69.648438 C 47.09375 69.613281 47.070312 68.339844 47.050781 66.824219 C 47.035156 65.304688 47.011719 63.941406 47 63.792969 C 46.988281 63.644531 46.980469 62.070312 46.980469 60.296875 C 46.976562 57.265625 46.96875 57.078125 46.890625 57.074219 C 46.839844 57.074219 46.660156 56.90625 46.484375 56.699219 L 46.171875 56.320312 L 46.179688 55.921875 L 46.191406 55.523438 L 44.375 55.492188 C 43.375 55.476562 41.878906 55.457031 41.050781 55.453125 L 39.535156 55.449219 Z M 39.535156 55.898438 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 27.058594 64.09375 C 26.492188 64.109375 25.976562 64.128906 25.914062 64.132812 L 25.796875 64.136719 L 25.828125 65.949219 C 25.859375 67.625 25.910156 69.484375 25.929688 69.5 C 25.929688 69.503906 26.585938 69.496094 27.386719 69.480469 L 28.84375 69.457031 L 28.875 68.734375 C 28.890625 68.339844 28.929688 67.480469 28.953125 66.828125 C 29.007812 65.554688 29.089844 64.433594 29.136719 64.1875 L 29.167969 64.035156 L 28.625 64.050781 C 28.324219 64.058594 27.621094 64.078125 27.058594 64.09375 Z M 27.058594 64.09375 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 67.265625 64.257812 C 66.699219 64.433594 66.214844 64.828125 65.988281 65.296875 C 65.910156 65.460938 65.84375 65.621094 65.84375 65.648438 C 65.84375 65.683594 66.238281 65.714844 67.082031 65.738281 C 67.761719 65.753906 68.691406 65.78125 69.148438 65.800781 L 69.984375 65.832031 L 69.941406 65.6875 C 69.753906 65.027344 69.128906 64.445312 68.414062 64.257812 C 68.105469 64.171875 67.53125 64.171875 67.265625 64.257812 Z M 67.265625 64.257812 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 69.265625 65.960938 C 69.320312 65.984375 69.503906 66.015625 69.679688 66.035156 C 69.9375 66.0625 69.988281 66.058594 69.988281 65.988281 C 69.988281 65.929688 69.917969 65.914062 69.578125 65.921875 C 69.320312 65.921875 69.203125 65.933594 69.265625 65.960938 Z M 69.265625 65.960938 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 69.589844 66.269531 C 68.699219 66.375 67.371094 66.457031 66.546875 66.457031 L 65.636719 66.457031 L 65.664062 67.257812 C 65.679688 67.703125 65.710938 68.605469 65.726562 69.273438 L 65.753906 70.484375 L 67.738281 70.46875 C 68.820312 70.457031 69.71875 70.441406 69.726562 70.433594 C 69.738281 70.421875 69.769531 69.910156 69.789062 69.289062 C 69.832031 68.128906 69.921875 66.636719 69.964844 66.398438 C 69.972656 66.324219 69.96875 66.257812 69.949219 66.246094 C 69.929688 66.238281 69.769531 66.246094 69.589844 66.269531 Z M 69.589844 66.269531 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 65.933594 71.085938 C 65.964844 71.09375 66.023438 71.09375 66.058594 71.085938 C 66.089844 71.070312 66.0625 71.058594 65.996094 71.058594 C 65.925781 71.058594 65.898438 71.070312 65.933594 71.085938 Z M 65.933594 71.085938 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 3.929688 73.914062 C 3.308594 74.066406 2.835938 74.777344 2.996094 75.3125 C 3.140625 75.796875 3.382812 76.09375 4.179688 76.75 C 4.796875 77.257812 4.890625 77.375 4.890625 77.640625 C 4.890625 77.820312 4.867188 77.878906 4.738281 77.984375 C 4.421875 78.246094 3.902344 78.105469 3.644531 77.691406 C 3.585938 77.597656 3.515625 77.519531 3.488281 77.519531 C 3.453125 77.519531 2.890625 77.84375 2.75 77.945312 C 2.726562 77.964844 2.949219 78.3125 3.113281 78.496094 C 3.195312 78.585938 3.398438 78.726562 3.5625 78.8125 C 3.839844 78.949219 3.914062 78.964844 4.316406 78.964844 C 4.6875 78.964844 4.808594 78.945312 4.992188 78.851562 C 5.570312 78.5625 5.800781 78.210938 5.800781 77.617188 C 5.800781 76.996094 5.640625 76.78125 4.421875 75.746094 C 3.820312 75.226562 3.75 75.09375 3.96875 74.878906 C 4.191406 74.648438 4.667969 74.761719 4.941406 75.113281 L 5.046875 75.246094 L 5.371094 74.964844 C 5.546875 74.8125 5.691406 74.660156 5.691406 74.625 C 5.691406 74.542969 5.214844 74.144531 4.960938 74.023438 C 4.71875 73.898438 4.203125 73.851562 3.929688 73.914062 Z M 3.929688 73.914062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 30.125 73.914062 C 28.433594 74.214844 27.53125 76.007812 28.289062 77.5625 C 28.597656 78.199219 29.117188 78.640625 29.851562 78.875 C 30.273438 79.015625 31.074219 79.003906 31.515625 78.855469 C 32.449219 78.546875 33.097656 77.660156 33.097656 76.6875 L 33.097656 76.382812 L 30.652344 76.382812 L 30.652344 77.273438 L 32.097656 77.273438 L 32.015625 77.40625 C 31.875 77.636719 31.632812 77.871094 31.425781 77.976562 C 31.253906 78.070312 31.144531 78.085938 30.699219 78.085938 C 30.203125 78.085938 30.160156 78.078125 29.863281 77.917969 C 29.492188 77.714844 29.238281 77.453125 29.070312 77.089844 C 28.957031 76.855469 28.949219 76.769531 28.964844 76.367188 C 28.972656 76.011719 29.003906 75.863281 29.09375 75.691406 C 29.257812 75.375 29.574219 75.074219 29.898438 74.917969 C 30.140625 74.796875 30.238281 74.785156 30.652344 74.785156 C 31.195312 74.785156 31.5 74.890625 31.894531 75.21875 L 32.113281 75.402344 L 32.433594 75.089844 L 32.746094 74.785156 L 32.609375 74.640625 C 32.179688 74.191406 31.550781 73.929688 30.816406 73.890625 C 30.574219 73.878906 30.265625 73.890625 30.125 73.914062 Z M 30.125 73.914062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 39.761719 73.917969 C 38.898438 74.0625 38.128906 74.683594 37.820312 75.5 C 37.230469 77.058594 38.234375 78.734375 39.890625 78.949219 C 41.039062 79.097656 41.972656 78.660156 42.46875 77.734375 C 42.625 77.429688 42.78125 76.855469 42.78125 76.5625 L 42.78125 76.382812 L 40.285156 76.382812 L 40.285156 77.273438 L 41.007812 77.273438 C 41.839844 77.273438 41.824219 77.261719 41.445312 77.675781 C 41.132812 78.011719 40.941406 78.085938 40.335938 78.085938 C 39.832031 78.085938 39.796875 78.082031 39.496094 77.917969 C 39.136719 77.726562 38.878906 77.460938 38.707031 77.097656 C 38.613281 76.902344 38.589844 76.773438 38.589844 76.433594 C 38.589844 76.070312 38.609375 75.96875 38.734375 75.714844 C 38.894531 75.378906 39.222656 75.058594 39.582031 74.890625 C 39.765625 74.808594 39.90625 74.785156 40.285156 74.785156 C 40.71875 74.777344 40.789062 74.792969 41.085938 74.9375 C 41.265625 75.019531 41.453125 75.132812 41.507812 75.183594 C 41.78125 75.425781 41.757812 75.429688 42.078125 75.105469 C 42.242188 74.9375 42.367188 74.773438 42.351562 74.738281 C 42.335938 74.703125 42.207031 74.585938 42.0625 74.46875 C 41.449219 73.984375 40.601562 73.78125 39.761719 73.917969 Z M 39.761719 73.917969 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 45.527344 73.914062 C 44.972656 74.007812 44.34375 74.367188 44.015625 74.773438 C 43.90625 74.910156 43.734375 75.191406 43.636719 75.394531 C 43.457031 75.765625 43.457031 75.765625 43.457031 76.4375 L 43.457031 77.109375 L 43.671875 77.539062 C 44.480469 79.152344 46.546875 79.488281 47.792969 78.214844 C 48.332031 77.65625 48.558594 77.058594 48.507812 76.285156 C 48.457031 75.574219 48.257812 75.128906 47.75 74.625 C 47.132812 74.011719 46.375 73.769531 45.527344 73.914062 Z M 46.664062 74.921875 C 47.34375 75.261719 47.683594 75.945312 47.574219 76.730469 C 47.425781 77.769531 46.285156 78.398438 45.3125 77.972656 C 44.988281 77.828125 44.613281 77.464844 44.472656 77.160156 C 44.308594 76.796875 44.304688 76.070312 44.464844 75.730469 C 44.589844 75.460938 44.933594 75.074219 45.148438 74.964844 C 45.632812 74.714844 46.222656 74.699219 46.664062 74.921875 Z M 46.664062 74.921875 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 64.984375 73.914062 C 64.417969 74.007812 63.953125 74.261719 63.554688 74.679688 C 62.117188 76.199219 63.023438 78.703125 65.109375 78.957031 C 66.535156 79.128906 67.632812 78.378906 67.917969 77.050781 C 67.957031 76.855469 67.992188 76.628906 67.992188 76.542969 L 67.992188 76.382812 L 65.496094 76.382812 L 65.496094 77.273438 L 66.21875 77.273438 C 67.046875 77.273438 67.03125 77.261719 66.652344 77.675781 C 66.34375 78.011719 66.148438 78.085938 65.546875 78.085938 C 64.917969 78.082031 64.667969 77.988281 64.289062 77.613281 C 63.804688 77.132812 63.648438 76.46875 63.871094 75.84375 C 64.003906 75.488281 64.367188 75.097656 64.730469 74.921875 C 64.984375 74.796875 65.074219 74.785156 65.496094 74.785156 C 65.90625 74.777344 66.003906 74.796875 66.242188 74.90625 C 66.394531 74.980469 66.617188 75.113281 66.742188 75.214844 L 66.960938 75.390625 L 67.273438 75.109375 C 67.441406 74.957031 67.582031 74.804688 67.582031 74.777344 C 67.585938 74.75 67.46875 74.628906 67.328125 74.511719 C 66.714844 74.003906 65.824219 73.777344 64.984375 73.914062 Z M 64.984375 73.914062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 8.015625 74.597656 C 7.789062 75.179688 7.257812 76.535156 7.039062 77.097656 C 6.609375 78.175781 6.390625 78.761719 6.390625 78.808594 C 6.390625 78.835938 6.566406 78.851562 6.847656 78.84375 L 7.3125 78.828125 L 7.507812 78.347656 L 7.703125 77.863281 L 9.757812 77.863281 L 9.929688 78.339844 C 10.019531 78.601562 10.125 78.820312 10.160156 78.832031 C 10.1875 78.847656 10.410156 78.851562 10.644531 78.84375 L 11.066406 78.828125 L 10.5 77.371094 C 9.949219 75.957031 9.753906 75.453125 9.355469 74.441406 L 9.171875 73.964844 L 8.261719 73.964844 Z M 8.878906 75.640625 C 8.9375 75.789062 9.070312 76.144531 9.179688 76.425781 C 9.289062 76.714844 9.375 76.949219 9.363281 76.960938 C 9.355469 76.96875 9.054688 76.96875 8.695312 76.964844 L 8.046875 76.949219 L 8.375 76.121094 C 8.554688 75.667969 8.722656 75.3125 8.746094 75.335938 C 8.765625 75.355469 8.824219 75.496094 8.878906 75.640625 Z M 8.878906 75.640625 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 11.867188 73.992188 C 11.847656 74.011719 11.832031 75.113281 11.832031 76.441406 L 11.832031 78.851562 L 12.753906 78.851562 L 12.746094 77.296875 C 12.746094 76.441406 12.753906 75.730469 12.773438 75.714844 C 12.792969 75.707031 12.972656 75.945312 13.175781 76.25 C 13.886719 77.339844 14.1875 77.800781 14.53125 78.320312 L 14.886719 78.851562 L 15.773438 78.851562 L 15.773438 73.957031 L 14.875 73.988281 L 14.875 75.578125 C 14.875 76.457031 14.859375 77.171875 14.839844 77.171875 C 14.816406 77.167969 14.476562 76.667969 14.078125 76.058594 C 13.679688 75.445312 13.207031 74.734375 13.027344 74.46875 L 12.703125 73.988281 L 12.304688 73.972656 C 12.082031 73.964844 11.886719 73.972656 11.867188 73.992188 Z M 11.867188 73.992188 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 18.894531 74.003906 C 18.878906 74.019531 18.871094 75.113281 18.871094 76.441406 L 18.871094 78.851562 L 21.167969 78.851562 L 21.167969 78.011719 L 19.769531 78.011719 L 19.769531 73.957031 L 19.34375 73.96875 C 19.113281 73.972656 18.910156 73.988281 18.894531 74.003906 Z M 18.894531 74.003906 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 21.898438 74 C 21.84375 74.046875 21.859375 77.304688 21.914062 77.683594 C 22 78.265625 22.25 78.589844 22.8125 78.847656 C 23.1875 79.019531 23.855469 79.023438 24.234375 78.855469 C 24.550781 78.71875 24.832031 78.457031 25 78.136719 L 25.136719 77.890625 L 25.148438 75.925781 L 25.164062 73.957031 L 24.726562 73.972656 L 24.285156 73.988281 L 24.261719 75.824219 C 24.234375 77.582031 24.230469 77.667969 24.132812 77.800781 C 23.820312 78.214844 23.15625 78.203125 22.878906 77.78125 C 22.796875 77.65625 22.789062 77.480469 22.773438 75.804688 L 22.753906 73.964844 L 22.34375 73.964844 C 22.113281 73.964844 21.914062 73.980469 21.898438 74 Z M 21.898438 74 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 26.242188 73.992188 C 26.222656 74.011719 26.207031 75.113281 26.207031 76.441406 L 26.207031 78.851562 L 27.15625 78.851562 L 27.148438 76.417969 L 27.132812 73.988281 L 26.707031 73.972656 C 26.472656 73.96875 26.261719 73.972656 26.242188 73.992188 Z M 26.242188 73.992188 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 33.945312 76.40625 L 33.945312 78.851562 L 34.84375 78.851562 L 34.835938 76.417969 L 34.820312 73.988281 L 34.386719 73.972656 L 33.945312 73.957031 Z M 33.945312 76.40625 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 49.457031 74 C 49.4375 74.011719 49.421875 75.113281 49.421875 76.441406 L 49.421875 78.851562 L 50.371094 78.851562 L 50.378906 77.265625 L 50.394531 75.683594 L 50.917969 76.472656 C 51.207031 76.910156 51.671875 77.617188 51.953125 78.046875 L 52.457031 78.828125 L 52.910156 78.84375 L 53.363281 78.855469 L 53.363281 73.953125 L 52.929688 73.972656 L 52.492188 73.988281 L 52.464844 75.59375 L 52.441406 77.199219 L 51.890625 76.375 C 51.59375 75.917969 51.109375 75.1875 50.824219 74.753906 L 50.308594 73.964844 L 49.894531 73.964844 C 49.671875 73.964844 49.472656 73.980469 49.457031 74 Z M 49.457031 74 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 54.261719 74.433594 L 54.261719 74.902344 L 55.0625 74.902344 C 55.5 74.902344 55.859375 74.917969 55.859375 74.929688 C 55.859375 74.957031 55.519531 75.742188 55.113281 76.65625 C 54.542969 77.9375 54.164062 78.800781 54.164062 78.820312 C 54.164062 78.835938 54.828125 78.851562 55.636719 78.851562 L 57.109375 78.851562 L 57.109375 78.011719 L 56.308594 78.011719 C 55.742188 78.011719 55.511719 77.996094 55.511719 77.957031 C 55.511719 77.921875 55.765625 77.320312 56.082031 76.609375 C 57.0625 74.382812 57.207031 74.046875 57.207031 74.007812 C 57.207031 73.984375 56.542969 73.964844 55.734375 73.964844 L 54.261719 73.964844 Z M 54.261719 74.433594 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 59.460938 74.074219 C 59.433594 74.136719 59.195312 74.738281 58.929688 75.421875 C 58.667969 76.097656 58.339844 76.929688 58.207031 77.273438 C 57.777344 78.351562 57.609375 78.796875 57.609375 78.828125 C 57.609375 78.84375 57.816406 78.851562 58.078125 78.851562 L 58.546875 78.851562 L 58.734375 78.359375 L 58.929688 77.863281 L 60.976562 77.863281 L 61.171875 78.359375 L 61.363281 78.851562 L 61.832031 78.851562 C 62.089844 78.851562 62.300781 78.84375 62.300781 78.828125 C 62.300781 78.8125 62.265625 78.71875 62.21875 78.613281 C 62.179688 78.515625 61.964844 77.96875 61.742188 77.394531 C 61.523438 76.824219 61.261719 76.15625 61.167969 75.914062 C 60.882812 75.1875 60.671875 74.648438 60.542969 74.308594 L 60.421875 73.988281 L 59.964844 73.972656 C 59.523438 73.957031 59.5 73.964844 59.460938 74.074219 Z M 60.269531 76.039062 C 60.429688 76.441406 60.574219 76.824219 60.589844 76.875 C 60.613281 76.96875 60.59375 76.976562 59.960938 76.976562 C 59.601562 76.976562 59.304688 76.960938 59.304688 76.945312 C 59.304688 76.882812 59.929688 75.296875 59.953125 75.296875 C 59.96875 75.296875 60.109375 75.628906 60.269531 76.039062 Z M 60.269531 76.039062 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 70.402344 74.003906 C 70.371094 74.023438 70.175781 74.480469 69.964844 75.023438 C 69.753906 75.570312 69.527344 76.144531 69.464844 76.308594 C 69.398438 76.472656 69.222656 76.925781 69.070312 77.320312 C 68.914062 77.714844 68.71875 78.203125 68.640625 78.414062 C 68.554688 78.621094 68.492188 78.800781 68.492188 78.816406 C 68.492188 78.835938 68.699219 78.851562 68.960938 78.851562 L 69.429688 78.851562 L 69.617188 78.359375 L 69.8125 77.863281 L 71.863281 77.863281 L 72.042969 78.34375 L 72.222656 78.828125 L 72.707031 78.84375 C 73.15625 78.855469 73.191406 78.847656 73.15625 78.769531 C 73.136719 78.71875 73.039062 78.457031 72.929688 78.183594 C 72.824219 77.914062 72.554688 77.226562 72.335938 76.65625 C 72.109375 76.082031 71.851562 75.414062 71.761719 75.171875 C 71.664062 74.925781 71.527344 74.5625 71.445312 74.359375 L 71.300781 73.988281 L 70.882812 73.980469 C 70.648438 73.972656 70.4375 73.984375 70.402344 74.003906 Z M 70.972656 75.578125 C 71.03125 75.734375 71.171875 76.097656 71.28125 76.382812 C 71.394531 76.667969 71.484375 76.917969 71.484375 76.9375 C 71.484375 76.960938 71.195312 76.976562 70.835938 76.976562 C 70.480469 76.976562 70.1875 76.957031 70.1875 76.9375 C 70.1875 76.917969 70.296875 76.621094 70.433594 76.285156 C 70.566406 75.945312 70.703125 75.582031 70.742188 75.480469 C 70.777344 75.378906 70.820312 75.296875 70.835938 75.296875 C 70.851562 75.296875 70.917969 75.425781 70.972656 75.578125 Z M 70.972656 75.578125 "/>
</g>
</svg>
</div>
    <h1>San Luigi</h1>
  </header>

  <nav>
    <button class="active" data-page="home">Home</button>
    <button data-page="settings">Impostazioni</button>
    <button data-page="history">Storico ordini</button>
  </nav>

  <!-- HOME -->
  <section id="home" class="page active">
    <div id="productsContainer" class="products"></div>

    <div class="cart">
      <table>
        <thead>
          <tr><th>Prodotto</th><th>Qt</th><th>Prezzo</th><th></th></tr>
        </thead>
        <tbody id="cartBody"></tbody>
      </table>
      <div class="total">Totale:  <span id="totalPrice">0.00</span></div>
      <button id="printAndSend" class="print">Stampa e invia</button>
    </div>
  </section>

  <!-- IMPOSTAZIONI -->
  <section id="settings" class="page">
    <div id="loginBox" class="panel">
      <div class="actions">
        <input type="password" id="settingsPassword" placeholder="Password" />
        <button id="loginBtn" class="btn">Accedi</button>
        <span class="muted">Default: <b>admin</b></span>
      </div>
    </div>

    <div id="settingsContent" style="display:none">
      <div class="panel">
        <h2>Categorie</h2>
        <div class="row-3">
          <input id="catName" placeholder="Nome categoria" />
          <input id="catColor" type="color" value="#3f51b5" />
          <input id="catOrder" type="number" placeholder="Ordine esposizione" />
        </div>
        <div class="actions" style="margin-top:8px">
          <button id="addCategory" class="btn">Aggiungi categoria</button>
        </div>
        <ul id="categoriesList"></ul>
      </div>

      <div class="panel">
        <h2>Prodotti</h2>
        <div class="row-4">
          <input id="prodName" placeholder="Nome prodotto" />
          <input id="prodPrice" type="number" step="0.01" placeholder="Prezzo" />
          <input id="prodQty" type="number" placeholder="Quantit (vuoto = illimitata)" />
          <select id="prodCategory"></select>
        </div>
        <div class="actions" style="margin-top:8px">
          <label class="actions"><input id="prodEnabled" type="checkbox" checked /> Abilitato</label>
          <button id="addProduct" class="btn">Aggiungi prodotto</button>
        </div>
        <ul id="productsList"></ul>
      </div>
    </div>
  </section>

  <!-- STORICO -->
  <section id="history" class="page">
    <div class="panel">
      <h2>Storico ordini</h2>
      <div class="actions">
        <input id="historyDate" type="date" />
        <button id="loadHistory" class="btn">Vai!</button>
        <button id="exportCSV" class="btn-ghost">Esporta CSV</button>
      </div>
    </div>

    <table id="historyTable">
      <thead><tr><th>Prodotto</th><th>Qt</th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="total" style="margin:8px 0 0">Totale incasso:  <span id="historyTotal">0.00</span></div>
  </section>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import {
      getFirestore, collection, addDoc, getDocs, doc, setDoc, getDoc,
      deleteDoc, updateDoc, query, where, orderBy, runTransaction, increment, serverTimestamp
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";
    import {
      getStorage, ref as storageRef, uploadBytes, getDownloadURL, deleteObject
    } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDNtqjDfxsV8TccejiE5Clffd1GvajryiU",
      authDomain: "bar-san-luigi.firebaseapp.com",
      projectId: "bar-san-luigi",
      storageBucket: "bar-san-luigi.firebasestorage.app",
      messagingSenderId: "26384635672",
      appId: "1:26384635672:web:672d98a954aa7e5dcaf06d"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // ---- Stato
    let categories = [];   // {id,name,color,order}
    let products = [];     // {id,name,price,qty,categoryId,enabled}
    let cart = [];

    // ---- Utils
    const byCatOrder = (a,b) => {
      const ca = categories.find(c=>c.id===a.categoryId);
      const cb = categories.find(c=>c.id===b.categoryId);
      return (ca?.order||0) - (cb?.order||0) || a.name.localeCompare(b.name);
    };
    const euros = v => (Number(v)||0).toFixed(2);

    // ---- Categorie (CRUD)
    async function loadCategories() {
      const qy = query(collection(db,"categories"), orderBy("order","asc"));
      const snap = await getDocs(qy);
      categories = snap.docs.map(d=>({id:d.id, ...d.data()}));
      renderCategoriesSettings();
      renderCategoryOptions();
    }
    function renderCategoriesSettings() {
      const ul = document.getElementById("categoriesList");
      ul.innerHTML = "";
      categories.forEach(c=>{
        const li = document.createElement("li");
        li.className = "item";
        li.innerHTML = `
          <div><b style="color:${c.color}">${c.name}</b> <span class="tag">ordine ${c.order||0}</span></div>
          <div class="actions">
            <button class="btn-ghost" onclick="editCategory('${c.id}')">Modifica</button>
            <button class="btn-ghost" onclick="deleteCategory('${c.id}')">Elimina</button>
          </div>`;
        ul.appendChild(li);
      });
    }
    function renderCategoryOptions() {
      const sel = document.getElementById("prodCategory");
      sel.innerHTML = "";
      categories.forEach(c=>{
        const opt = document.createElement("option");
        opt.value = c.id; opt.textContent = c.name;
        sel.appendChild(opt);
      });
    }
    document.getElementById("addCategory").onclick = async ()=>{
      const name = document.getElementById("catName").value.trim();
      const color = document.getElementById("catColor").value;
      const order = parseInt(document.getElementById("catOrder").value)||0;
      if(!name){ alert("Inserisci un nome categoria."); return; }
      await addDoc(collection(db,"categories"), {name,color,order});
      document.getElementById("catName").value="";
      document.getElementById("catOrder").value="";
      await loadCategories(); renderProductsHome();
    };
    window.editCategory = async (id)=>{
      const c = categories.find(x=>x.id===id); if(!c) return;
      const name = prompt("Nome categoria:", c.name); if(!name) return;
      const color = prompt("Colore HEX (#...):", c.color)||c.color;
      const order = parseInt(prompt("Ordine di esposizione:", c.order))||0;
      await updateDoc(doc(db,"categories",id), {name,color,order});
      await loadCategories(); renderProductsHome();
    };
    window.deleteCategory = async (id)=>{
      if(!confirm("Eliminare la categoria? I prodotti resteranno ma senza colore/ordine.")) return;
      await deleteDoc(doc(db,"categories",id));
      await loadCategories(); renderProductsHome();
    };

    // ---- Prodotti (CRUD + toggle)
    async function loadProducts() {
      const snap = await getDocs(collection(db,"products"));
      products = snap.docs.map(d=>{
        const data = d.data();
        return { id:d.id, enabled: data.enabled!==false, ...data };
      });
      renderProductsSettings();
    }
    function renderProductsSettings() {
      const ul = document.getElementById("productsList");
      ul.innerHTML = "";
      // Mostra per categoria per ordine
      const sorted = [...products].sort(byCatOrder);
      sorted.forEach(p=>{
        const cat = categories.find(c=>c.id===p.categoryId);
        const li = document.createElement("li");
        li.className = "item";
        const qtyStr = (p.qty===null || p.qty===undefined) ? "" : p.qty;
        li.innerHTML = `
          <div>
            <b>${p.name}</b> <span class="muted">${euros(p.price)}</span>
            <span class="tag">${cat ? cat.name : "Senza categoria"}</span>
            <span class="tag">Qt: ${qtyStr}</span>
            <span class="tag">${p.enabled ? "Attivo " : "Disattivo "}</span>
          </div>
          <div class="actions">
            <button class="btn-ghost" onclick="editProduct('${p.id}')">Modifica</button>
            <button class="btn-ghost" onclick="toggleProduct('${p.id}')">${p.enabled?"Disattiva":"Attiva"}</button>
            <button class="btn-ghost" onclick="deleteProduct('${p.id}')">Elimina</button>
          </div>`;
        ul.appendChild(li);
      });
    }
    function renderProductsHome() {
      const container = document.getElementById("productsContainer");
      container.innerHTML = "";
      // Itera le categorie in ordine e per ciascuna butta i prodotti abilitati
      categories.forEach(cat=>{
        const prods = products
          .filter(p=>p.categoryId===cat.id && p.enabled)
          .sort((a,b)=> a.name.localeCompare(b.name));
        prods.forEach(p=>{
          const btn = document.createElement("button");
          btn.className = "prod-btn";
          btn.style.background = cat.color || "#777";
          const qtyStr = (p.qty===null || p.qty===undefined) ? "" : `<span class="prod-caption">Rimanenti: ${p.qty}</span>`;
          btn.innerHTML = `${p.name}${qtyStr}`;
          btn.onclick = ()=> addToCart(p);
          container.appendChild(btn);
        });
      });
    }
    document.getElementById("addProduct").onclick = async ()=>{
      const name = document.getElementById("prodName").value.trim();
      const price = parseFloat(document.getElementById("prodPrice").value);
      const qtyRaw = document.getElementById("prodQty").value;
      const qty = (qtyRaw==="" ? null : parseInt(qtyRaw));
      const categoryId = document.getElementById("prodCategory").value;
      const enabled = document.getElementById("prodEnabled").checked;
      if(!name || isNaN(price)){ alert("Nome e prezzo sono obbligatori."); return; }
      await addDoc(collection(db,"products"), { name, price, qty, categoryId, enabled });
      document.getElementById("prodName").value = "";
      document.getElementById("prodPrice").value = "";
      document.getElementById("prodQty").value = "";
      document.getElementById("prodEnabled").checked = true;
      await loadProducts(); renderProductsHome();
    };
    window.editProduct = async (id)=>{
      const p = products.find(x=>x.id===id); if(!p) return;
      const name = prompt("Nome prodotto:", p.name); if(!name) return;
      const price = parseFloat(prompt("Prezzo:", p.price)); if(isNaN(price)) return;
      const qtyPrompt = prompt("Quantit (vuoto=illimitata):", (p.qty ?? "").toString());
      const qty = (qtyPrompt==="" ? null : parseInt(qtyPrompt));
      // cambio categoria via select testuale: mostra elenco id->nome
      const catList = categories.map(c=>`${c.id} = ${c.name}`).join("\n");
      const categoryId = prompt("ID categoria (scegli tra):\n"+catList, p.categoryId) || p.categoryId;
      await updateDoc(doc(db,"products",id), { name, price, qty, categoryId });
      await loadProducts(); renderProductsHome();
    };
    window.toggleProduct = async (id)=>{
      const p = products.find(x=>x.id===id); if(!p) return;
      await updateDoc(doc(db,"products",id), { enabled: !p.enabled });
      await loadProducts(); renderProductsHome();
    };
    window.deleteProduct = async (id)=>{
      if(!confirm("Eliminare questo prodotto?")) return;
      await deleteDoc(doc(db,"products",id));
      await loadProducts(); renderProductsHome();
    };

    // ---- Carrello
    function inCartQty(productId) {
      return cart.filter(i=>i.id===productId).reduce((s,i)=>s+i.qty,0);
    }
    function addToCart(prod) {
      // rispetta la giacenza se definita
      if (prod.qty !== null && prod.qty !== undefined) {
        const already = inCartQty(prod.id);
        if (already + 1 > prod.qty) { alert("Giacenza insufficiente."); return; }
      }
      const found = cart.find(i=>i.id===prod.id);
      if(found) found.qty++; else cart.push({ id:prod.id, name:prod.name, price:prod.price, qty:1 });
      renderCart();
    }
    function renderCart() {
      const tbody = document.getElementById("cartBody");
      tbody.innerHTML = "";
      let total = 0;
      cart.forEach((it,idx)=>{
        total += it.price * it.qty;
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${it.name}</td>
          <td>${it.qty}</td>
          <td> ${euros(it.price * it.qty)}</td>
          <td><button class="rmv btn-ghost" onclick="removeFromCart(${idx})">-</button></td>`;
        tbody.appendChild(tr);
      });
      document.getElementById("totalPrice").textContent = euros(total);
    }
    window.removeFromCart = (idx)=>{
      cart[idx].qty--;
      if (cart[idx].qty <= 0) cart.splice(idx,1);
      renderCart();
    };

    // ---- Numero progressivo
    async function nextOrderNumber() {
      const ref = doc(db,"counters","orders");
      const orderNo = await runTransaction(db, async (tx)=>{
        const snap = await tx.get(ref);
        if(!snap.exists()) {
          tx.set(ref, { seq: 1 });
          return 1;
        } else {
          const next = (snap.data().seq||0) + 1;
          tx.update(ref, { seq: next });
          return next;
        }
      });
      return orderNo;
    }

    // ---- Stampa + Salvataggio ordine + Scarico magazzino
    document.getElementById("printAndSend").onclick = async ()=>{
      if(cart.length===0){ alert("Carrello vuoto."); return; }
      // determina numero progressivo
      const orderNo = await nextOrderNumber();
      const order = {
        number: orderNo,
        date: serverTimestamp(),
        items: cart.map(c=>({ name:c.name, qty:c.qty, price:c.price })),
        total: cart.reduce((s,c)=>s + c.price*c.qty, 0)
      };

      // PREPARA STAMPA
      const logoSrc = document.getElementById("barLogo").src || "";
      const dt = new Date().toLocaleString();
      let html = `
        <div style="width:80mm;font-family:monospace;">
          <div style="text-align:center">
            ${logoSrc ? `<img src="${logoSrc}" style="max-width:60mm;max-height:40mm" />` : ""}
            <h2 style="margin:6px 0">San Luigi</h2>
            <div>${dt}</div>
            <div>Ordine #${orderNo}</div>
          </div>
          <hr/>
      `;
      order.items.forEach(it=>{
        html += `
          <div style="display:flex;justify-content:space-between;">
            <span>${it.qty} x ${it.name}</span>
            <span> ${euros(it.price*it.qty)}</span>
          </div>`;
      });
      html += `<hr/><div style="text-align:right;font-weight:bold">TOTALE:  ${euros(order.total)}</div></div>`;

      const w = window.open("", "PRINT", "width=420,height=640");
      w.document.write(html);
      w.document.close();
      w.focus();
      w.print();
      w.close();

      // SALVA ORDINE
      await addDoc(collection(db,"orders"), order);

      // SCALA MAGAZZINO SE SERVE
      // (usa increment negativo)
      for (const line of cart) {
        const prod = products.find(p=>p.id===line.id);
        if (prod && prod.qty !== null && prod.qty !== undefined) {
          const ref = doc(db,"products", prod.id);
          await updateDoc(ref, { qty: increment(-line.qty) });
        }
      }

      // Pulisci cart e ricarica prodotti (cos si aggiornano le giacenze visibili)
      cart = [];
      renderCart();
      await loadProducts();
      renderProductsHome();
    };

    // ---- Storico
    document.getElementById("loadHistory").onclick = async ()=>{
      const dateStr = document.getElementById("historyDate").value;
      if(!dateStr){ alert("Seleziona una data."); return; }
      const start = new Date(dateStr+"T00:00:00");
      const end   = new Date(dateStr+"T23:59:59");
      const qy = query(collection(db,"orders"), where("date", ">=", start), where("date","<=", end));
      const snap = await getDocs(qy);
      const summary = {};
      let total = 0;
      snap.forEach(d=>{
        const o = d.data();
        (o.items||[]).forEach(it=>{
          summary[it.name] = (summary[it.name]||0) + (it.qty||0);
          total += (it.price||0) * (it.qty||0);
        });
      });
      const tbody = document.querySelector("#historyTable tbody");
      tbody.innerHTML = "";
      Object.entries(summary).forEach(([name,qty])=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${name}</td><td>${qty}</td>`;
        tbody.appendChild(tr);
      });
      document.getElementById("historyTotal").textContent = euros(total);
    };

    document.getElementById("exportCSV").onclick = ()=>{
      const rows = [["Prodotto","Quantit"]];
      document.querySelectorAll("#historyTable tbody tr").forEach(tr=>{
        const tds = tr.querySelectorAll("td");
        rows.push([tds[0].textContent, tds[1].textContent]);
      });
      const csv = rows.map(r=>r.join(",")).join("\n");
      const blob = new Blob([csv], {type:"text/csv"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "storico.csv"; a.click();
      URL.revokeObjectURL(url);
    };

    // ---- Login Impostazioni
    document.getElementById("loginBtn").onclick = ()=>{
      if (document.getElementById("settingsPassword").value === "admin") {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("settingsContent").style.display = "block";
      } else { alert("Password errata"); }
    };

    // ---- Navigazione
    document.querySelectorAll("nav button").forEach(btn=>{
      btn.onclick = ()=>{
        document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
        document.getElementById(btn.dataset.page).classList.add("active");
      };
    });

    // ---- Init: carica tutto & poi render Home
    await Promise.all([loadLogo(), loadCategories(), loadProducts()]);
    renderProductsHome();
  </script>
</body>
</html>
